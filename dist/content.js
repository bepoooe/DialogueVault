(()=>{"use strict";class e{static detectPlatform(){const e=window.location.hostname.toLowerCase();return window.location.href.toLowerCase(),console.log("[DialogueVault] Detecting platform for:",e),e.includes("chat.openai.com")||e.includes("chatgpt.com")?(console.log("[DialogueVault] Detected ChatGPT"),this.configs.chatgpt):e.includes("claude.ai")?(console.log("[DialogueVault] Detected Claude"),this.configs.claude):e.includes("gemini.google.com")||e.includes("bard.google.com")?(console.log("[DialogueVault] Detected Gemini"),this.configs.gemini):e.includes("chat.deepseek.com")||e.includes("deepseek.com")?(console.log("[DialogueVault] Detected DeepSeek"),this.configs.deepseek):e.includes("poe.com")?(console.log("[DialogueVault] Detected Poe"),this.configs.poe):e.includes("you.com")?(console.log("[DialogueVault] Detected You.com"),this.configs.you):e.includes("character.ai")?(console.log("[DialogueVault] Detected Character.AI"),this.configs.character):e.includes("chat.mistral.ai")||e.includes("mistral.ai")?(console.log("[DialogueVault] Detected Mistral"),this.configs.mistral):e.includes("huggingface.co")?(console.log("[DialogueVault] Detected Hugging Face"),this.configs.huggingface):e.includes("chat.lmsys.org")?(console.log("[DialogueVault] Detected LMSYS"),this.configs.lmsys):(console.log("[DialogueVault] Unknown platform, using generic config"),this.configs.unknown)}static getConfig(e){return this.configs[e]}}e.configs={chatgpt:{name:"ChatGPT",platform:"chatgpt",messageSelectors:["[data-message-author-role]",".group\\/conversation-turn",".group.w-full",'[data-testid*="conversation-turn"]'],userIndicators:['[data-message-author-role="user"]','img[alt*="User"]',".relative.p-1.rounded-sm"],assistantIndicators:['[data-message-author-role="assistant"]','svg[class*="icon"]','[data-testid*="turn"]',".markdown"],textSelectors:['div[class*="markdown"]',".prose","p","div"]},claude:{name:"Claude",platform:"claude",messageSelectors:['[data-testid="message"]',"[data-is-streaming]",'div[class*="font-claude"]',".flex.flex-col.gap-3",".group.relative"],userIndicators:['[data-is-streaming="false"][class*="border"]',".bg-bg-300",'div[class*="user"]'],assistantIndicators:["[data-is-streaming]",".font-claude",'div[class*="assistant"]','svg[class*="claude"]'],textSelectors:[".font-claude-message",".prose","p",'div[class*="text"]',"span"]},gemini:{name:"Gemini",platform:"gemini",messageSelectors:['[data-test-id*="conversation"]',"message-content",".conversation-container > div",'div[class*="message"]',".model-response-container"],userIndicators:['[data-test-id="user-message"]',".user-input-container",'div[class*="user"]'],assistantIndicators:['[data-test-id*="model-response"]',".model-response-container",'div[class*="response"]','div[class*="assistant"]'],textSelectors:[".response-container-content",".markdown-content",".message-content","p","div"]},deepseek:{name:"DeepSeek",platform:"deepseek",messageSelectors:[".message-item","[data-role]",".chat-message",".conversation-message"],userIndicators:['[data-role="user"]',".message-user",".user-message"],assistantIndicators:['[data-role="assistant"]',".message-assistant",".assistant-message",".ai-message"],textSelectors:[".message-content",".text-content",".markdown","p","div"]},poe:{name:"Poe",platform:"poe",messageSelectors:['[class*="Message_messageRow"]','[class*="message"]',".ChatMessageInputContainer",'div[class*="Message"]'],userIndicators:['[class*="Message_humanMessageBubble"]','[class*="human"]','[class*="user"]'],assistantIndicators:['[class*="Message_botMessageBubble"]','[class*="bot"]','[class*="assistant"]'],textSelectors:['[class*="Markdown"]','[class*="message"] p','div[class*="text"]',"span"]},you:{name:"You.com",platform:"you",messageSelectors:['[data-testid*="message"]',".chat-message",".message-container"],userIndicators:['[data-testid="user-message"]',".user-message",'[class*="user"]'],assistantIndicators:['[data-testid*="ai-message"]',".ai-message",'[class*="assistant"]','[class*="bot"]'],textSelectors:[".message-text",".markdown","p","div"]},character:{name:"Character.AI",platform:"character",messageSelectors:['[data-testid="message"]',".message",'[class*="Message"]'],userIndicators:['[data-author="user"]',".user-message",'[class*="user"]'],assistantIndicators:['[data-author*="char"]',".character-message",'[class*="character"]','[class*="bot"]'],textSelectors:[".message-text",".text","p","span"]},mistral:{name:"Mistral",platform:"mistral",messageSelectors:[".message",'[data-testid*="message"]',".chat-message"],userIndicators:[".user-message",'[data-role="user"]','[class*="user"]'],assistantIndicators:[".assistant-message",'[data-role="assistant"]','[class*="assistant"]'],textSelectors:[".message-content",".markdown","p","div"]},huggingface:{name:"Hugging Face",platform:"huggingface",messageSelectors:['[data-testid="message"]',".message",".chat-message"],userIndicators:['[data-from="user"]',".from-user",'[class*="user"]'],assistantIndicators:['[data-from="assistant"]',".from-assistant",'[class*="assistant"]'],textSelectors:[".prose",".message-content","p","div"]},lmsys:{name:"LMSYS Chatbot Arena",platform:"lmsys",messageSelectors:[".message",'[role="log"]',".chatbot"],userIndicators:[".user",'[class*="user"]'],assistantIndicators:[".bot",".assistant",'[class*="bot"]'],textSelectors:[".message","p","div"]},unknown:{name:"Unknown Platform",platform:"unknown",messageSelectors:[".message",'[data-testid*="message"]','[class*="message"]','[class*="chat"]','div[role="log"]'],userIndicators:['[class*="user"]','[data-role="user"]','[data-author="user"]'],assistantIndicators:['[class*="assistant"]','[class*="bot"]','[data-role="assistant"]','[data-author*="assistant"]'],textSelectors:[".text",".content",".markdown","p","div","span"]}};class t{constructor(){this.observer=null,this.updateCallback=null,this.platformConfig=e.detectPlatform(),this.platform=this.platformConfig.platform,console.log(`[DialogueVault] Initialized for ${this.platformConfig.name}`)}debugPageStructure(){console.log("[DialogueVault] === DEBUG PAGE STRUCTURE ==="),console.log("[DialogueVault] Platform:",this.platformConfig.name),console.log("[DialogueVault] URL:",window.location.href),console.log("[DialogueVault] Title:",document.title);const e=document.querySelector("main")||document.body;if(console.log("[DialogueVault] Main element:",e?"found":"not found"),e){console.log("[DialogueVault] Main children count:",e.children.length);const t=e.querySelectorAll("div");console.log("[DialogueVault] Divs in main:",t.length),Array.from(t).filter(e=>(e.textContent?.trim()||"").length>30).slice(0,5).forEach((e,t)=>{const s=e.textContent?.trim().substring(0,100)+"...";console.log(`[DialogueVault] Text div ${t}:`,s),console.log("[DialogueVault] Classes:",e.className),console.log("[DialogueVault] Data attrs:",Array.from(e.attributes).filter(e=>e.name.startsWith("data-")))})}this.platformConfig.messageSelectors.forEach(e=>{const t=document.querySelectorAll(e);console.log(`[DialogueVault] Selector "${e}": ${t.length} elements`)})}startObserving(e){this.updateCallback=e,this.observer=new MutationObserver(e=>{let t=!1;for(const s of e)if("childList"===s.type&&Array.from(s.addedNodes).some(e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e;return this.platformConfig.messageSelectors.some(e=>t.matches(e)||t.querySelector(e))}return!1})){t=!0;break}t&&setTimeout(()=>{this.updateCallback&&this.updateCallback()},500)});const t=this.platformConfig.containerSelector&&document.querySelector(this.platformConfig.containerSelector)||document.body;this.observer.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","data-message-author-role","data-testid","data-role","data-author","data-from"]})}stopObserving(){this.observer&&(this.observer.disconnect(),this.observer=null)}getConversationTurns(){const e=[];console.log(`[DialogueVault] Starting conversation detection for ${this.platformConfig.name}...`),console.log("[DialogueVault] Current URL:",window.location.href);let t=[];for(const e of this.platformConfig.messageSelectors){const s=document.querySelectorAll(e);if(console.log(`[DialogueVault] Selector "${e}" found ${s.length} elements`),s.length>0){const n=Array.from(s).filter(e=>(e.textContent?.trim()||"").length>20);if(n.length>0){t=n,console.log(`[DialogueVault] Using ${n.length} valid elements from selector: ${e}`);break}}}if(0===t.length){console.log("[DialogueVault] No elements found with specific selectors, trying general approach...");const e=document.querySelector("main")||document.querySelector('[role="main"]')||document.querySelector(".chat")||document.querySelector('[class*="chat"]')||document.querySelector('[class*="conversation"]')||document.body;if(e){const s=e.querySelectorAll("div");console.log(`[DialogueVault] Found ${s.length} divs in container`),t=Array.from(s).filter(e=>{const t=e.textContent?.trim()||"",s=t.length>50,n=e.children.length>0,a=e.querySelectorAll("div").length<50,o=e.className.toLowerCase().match(/message|chat|conversation|turn|response|prompt/);return s&&n&&a&&(o||t.length>100)}),console.log(`[DialogueVault] Filtered to ${t.length} potential message elements`)}}return 0===t.length?(console.log("[DialogueVault] No conversation elements found at all"),e):(t.forEach((t,s)=>{const n=t,a=this.determineRole(n);if(a){const t=this.extractPreview(n);t&&t.length>3&&(console.log(`[DialogueVault] Turn ${e.length+1}: ${a} - "${t.substring(0,60)}..."`),e.push({index:e.length,type:a,preview:t,element:n}))}}),console.log(`[DialogueVault] Final result: ${e.length} conversation turns found`),e)}determineRole(e){console.log(`[DialogueVault] Determining role for element with class: ${e.className}`);for(const t of this.platformConfig.userIndicators)if(e.matches(t)||e.querySelector(t))return console.log(`[DialogueVault] Found user role via selector: ${t}`),"user";for(const t of this.platformConfig.assistantIndicators)if(e.matches(t)||e.querySelector(t))return console.log(`[DialogueVault] Found assistant role via selector: ${t}`),"assistant";let t=e;for(let e=0;e<3&&t;e++){const e=["data-message-author-role","data-role","data-author","data-from","data-testid"];for(const s of e){const e=t.getAttribute(s)?.toLowerCase()||"";if(e.includes("user")||e.includes("human"))return console.log(`[DialogueVault] Found user role via ${s}="${e}"`),"user";if(e.includes("assistant")||e.includes("bot")||e.includes("ai")||e.includes("gpt")||e.includes("claude")||e.includes("gemini"))return console.log(`[DialogueVault] Found assistant role via ${s}="${e}"`),"assistant"}t=t.parentElement}const s=['img[alt*="user" i]','img[alt*="you" i]','[class*="user" i]','[class*="human" i]','div[style*="align-items: flex-end"]','div[style*="justify-content: flex-end"]'];for(const t of s)if(e.querySelector(t))return console.log(`[DialogueVault] Found user indicator via pattern: ${t}`),"user";const n=["svg",'[class*="bot" i]','[class*="ai" i]','[class*="assistant" i]','[class*="gpt" i]','[class*="claude" i]','[class*="gemini" i]','img[alt*="bot" i]','img[alt*="ai" i]',"code","pre",".markdown"];for(const t of n)if(e.querySelector(t))return console.log(`[DialogueVault] Found assistant indicator via pattern: ${t}`),"assistant";const a=document.querySelector("main")||document.body;if(a){const t=a.querySelectorAll("div"),s=Array.from(t).filter(e=>(e.textContent?.trim()||"").length>50),n=Array.from(s).findIndex(t=>t===e);if(n>=0){const e=n%2==0?"user":"assistant";return console.log(`[DialogueVault] Using alternating pattern: index ${n} = ${e}`),e}}return console.log("[DialogueVault] Could not determine role, returning null"),null}extractPreview(e){for(const t of this.platformConfig.textSelectors){const s=e.querySelector(t);if(s&&s.textContent){const e=s.textContent.trim();if(e.length>10)return this.truncateText(e,100)}}const t=[".markdown",".prose",'[class*="content"]','[class*="text"]','[class*="message"]',"p","span","div"];for(const s of t){const t=e.querySelector(s);if(t&&t.textContent){const e=t.textContent.trim();if(e.length>10)return this.truncateText(e,100)}}let s=e.textContent?.trim()||"";return s=s.replace(/\s+/g," ").trim(),s.length<3?"Message":this.truncateText(s,100)}truncateText(e,t){return e.length<=t?e:e.substring(0,t-3)+"..."}getPlatformName(){return this.platformConfig.name}}new class{constructor(){this.sidebar=null,this.promptList=null,this.isVisible=!0,this.prompts=[],this.observer=null,this.debounceTimer=null,this.expandBtn=null,this.isMobile=window.matchMedia("(max-width: 768px)").matches,this.selectedPromptId=null,this.navigator=new t,this.platformName=this.navigator.getPlatformName(),console.log(`[DialogueVault] Initializing extension for ${this.platformName}`),this.init()}init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.setup()):this.setup()}setup(){this.createSidebar(),this.createFloatingExpandBtn(),this.setupObserver(),this.scanForPrompts(),this.setupKeyboardShortcuts(),window.addEventListener("resize",()=>this.handleResize()),this.handleResize();const e=()=>{this.positionExpandBtnDesktop(),this.positionExpandBtnMobile()};window.addEventListener("scroll",e,{passive:!0}),setInterval(e,800)}setupObserver(){this.navigator.startObserving(()=>{this.scanForPrompts()})}scanForPrompts(){console.log(`[DialogueVault] Scanning for prompts on ${this.platformName}...`);const e=this.navigator.getConversationTurns();if(0===e.length)return console.log("[DialogueVault] No conversation messages found"),this.prompts=[],void this.updatePromptList();console.log(`[DialogueVault] Found ${e.length} messages`),this.prompts=e.map((e,t)=>({id:`turn-${t}`,text:e.preview,isUser:"user"===e.type,element:e.element,preview:e.preview})),console.log(`[DialogueVault] Parsed ${this.prompts.length} conversation items`),this.updatePromptList()}setupKeyboardShortcuts(){document.addEventListener("keydown",e=>{e.ctrlKey&&e.shiftKey&&"I"===e.key&&(e.preventDefault(),this.toggleSidebar())})}updatePromptList(){if(!this.promptList)return;if(this.promptList.innerHTML="",0===this.prompts.length){const e=document.createElement("div");return e.className="empty-state",e.textContent="No conversation detected. Start chatting to see your message index here.",e.style.cssText="\n        text-align: center;\n        padding: 40px 24px;\n        color: #8b7355;\n        font-size: 13px;\n        line-height: 1.5;\n      ",void this.promptList.appendChild(e)}const e=document.createElement("div");e.textContent=`${this.platformName} Conversation`,e.style.cssText="\n      padding: 12px 20px;\n      color: #8b7355;\n      font-size: 11px;\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      border-bottom: 1px solid #e5d6c3;\n      background: #e8dbc9;\n      font-weight: 600;\n    ",this.promptList.appendChild(e),this.prompts.forEach(e=>{const t=document.createElement("div");t.className="prompt-item",t.style.cssText="\n        padding: 16px 20px;\n        border-bottom: 1px solid #e5d6c3;\n        cursor: pointer;\n        transition: all 0.15s ease;\n        background: #ffffff;\n        margin: 0;\n        position: relative;\n        border-radius: 8px;\n        margin: 4px;\n        box-shadow: 0 1px 3px rgba(93, 78, 55, 0.1);\n      ";const s=document.createElement("div");s.style.cssText=`\n        position: absolute;\n        left: 0;\n        top: 0;\n        bottom: 0;\n        width: 4px;\n        background: ${e.isUser?"#d4c4a8":"#d2c2a6"};\n        border-radius: 0 4px 4px 0;\n      `;const n=document.createElement("div");n.textContent=e.isUser?"You":this.getAssistantName(),n.style.cssText=`\n        font-size: 11px;\n        color: ${e.isUser?"#8b7355":"#5d4e37"};\n        margin-bottom: 8px;\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 0.05em;\n        padding-left: 12px;\n      `;const a=document.createElement("div");a.textContent=e.preview,a.style.cssText="\n        font-size: 13px;\n        line-height: 1.4;\n        color: #5d4e37;\n        margin-left: 12px;\n        overflow: hidden;\n        display: -webkit-box;\n        -webkit-line-clamp: 3;\n        -webkit-box-orient: vertical;\n        line-clamp: 3;\n      ",t.appendChild(s),t.appendChild(n),t.appendChild(a),t.addEventListener("mouseover",()=>{t.style.backgroundColor="#eee3d5",t.style.transform="translateY(-1px)",t.style.boxShadow="0 2px 6px rgba(93, 78, 55, 0.15)"}),t.addEventListener("mouseout",()=>{this.selectedPromptId!==e.id&&(t.style.backgroundColor="#ffffff",t.style.transform="translateY(0)",t.style.boxShadow="0 1px 3px rgba(93, 78, 55, 0.1)")}),t.addEventListener("click",()=>{this.scrollToPrompt(e),this.setSelectedPrompt(e.id,t)}),this.promptList&&this.promptList.appendChild(t)})}getAssistantName(){switch(this.platformName){case"ChatGPT":return"ChatGPT";case"Claude":return"Claude";case"Gemini":return"Gemini";case"DeepSeek":return"DeepSeek";case"Poe":case"LMSYS Chatbot Arena":return"Bot";case"You.com":return"You.com";case"Character.AI":return"Character";case"Mistral":return"Mistral";default:return"Assistant"}}scrollToPrompt(e){e.element.scrollIntoView({behavior:"smooth",block:"center"});const t=e.element.style.backgroundColor,s=e.element.style.transition;e.element.style.backgroundColor="#e8dbc9",e.element.style.transition="background-color 0.3s ease",setTimeout(()=>{e.element.style.backgroundColor=t,e.element.style.transition=s},2e3)}setSelectedPrompt(e,t){this.promptList?.querySelectorAll(".prompt-item").forEach(e=>{e.style.backgroundColor="#ffffff",e.style.transform="translateY(0)",e.style.boxShadow="0 1px 3px rgba(93, 78, 55, 0.1)"}),this.selectedPromptId=e,t.style.backgroundColor="#e8dbc9",t.style.boxShadow="0 2px 8px rgba(93, 78, 55, 0.15)"}applySelectedStyling(){if(this.selectedPromptId&&this.promptList){const e=Array.from(this.promptList.querySelectorAll(".prompt-item")).find(e=>{const t=Array.from(this.promptList.children).indexOf(e)-1;return this.prompts[t]?.id===this.selectedPromptId});e&&(e.style.backgroundColor="#e8dbc9",e.style.boxShadow="0 2px 8px rgba(93, 78, 55, 0.15)")}}handleResize(){this.isMobile=window.matchMedia("(max-width: 768px)").matches,this.isMobile?(this.isVisible=!1,this.sidebar&&(this.sidebar.classList.remove("active"),this.sidebar.classList.add("collapsed"),this.sidebar.style.display="none"),this.positionExpandBtnMobile(),this.showExpandBtn()):(this.isVisible?this.showSidebar():this.hideSidebar(),this.positionExpandBtnDesktop())}createSidebar(){this.sidebar=document.createElement("div"),this.sidebar.id="dialoguevault-navigator",this.sidebar.className="dialoguevault-navigator-sidebar",this.sidebar.style.cssText="\n      position: fixed;\n      top: 0;\n      right: 0;\n      width: 320px;\n      height: 100vh;\n      background: #e6d7c4;\n      border-left: 1px solid #d4c4a8;\n      z-index: 10000;\n      display: flex;\n      flex-direction: column;\n      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n      transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n      box-shadow: -2px 0 12px rgba(93, 78, 55, 0.15);\n    ";const e=document.createElement("div");e.className="sidebar-header",e.style.cssText="\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 20px;\n      border-bottom: 1px solid #d4c4a8;\n      background: #e4d5c2;\n      min-height: 60px;\n    ";const t=document.createElement("h3");t.textContent="DialogueVault",t.className="sidebar-title",t.style.cssText="\n      margin: 0;\n      color: #5d4e37;\n      font-size: 16px;\n      font-weight: 600;\n      letter-spacing: 0.025em;\n    ";const s=document.createElement("button");s.className="close-btn",s.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n        <path d="M18 6L6 18M6 6l12 12"/>\n      </svg>\n    ',s.title="Close sidebar",s.style.cssText="\n      background: none;\n      border: none;\n      color: #8b7355;\n      cursor: pointer;\n      padding: 8px;\n      border-radius: 8px;\n      transition: all 0.15s ease;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n    ",s.addEventListener("click",()=>this.hideSidebar()),s.addEventListener("mouseover",()=>{s.style.backgroundColor="#ddceb9",s.style.color="#5d4e37"}),s.addEventListener("mouseout",()=>{s.style.backgroundColor="transparent",s.style.color="#8b7355"}),e.appendChild(t),e.appendChild(s),this.promptList=document.createElement("div"),this.promptList.className="prompt-list",this.promptList.style.cssText="\n      flex: 1;\n      overflow-y: auto;\n      background: #e6d7c4;\n      padding: 8px;\n    ";const n=document.createElement("div");n.className="empty-state",n.textContent="No conversation detected. Start chatting to see your message index here.",n.style.cssText="\n      text-align: center;\n      padding: 40px 24px;\n      color: #8b7355;\n      font-size: 13px;\n      line-height: 1.5;\n    ",this.promptList.appendChild(n),this.sidebar.appendChild(e),this.sidebar.appendChild(this.promptList),document.body.appendChild(this.sidebar)}createFloatingExpandBtn(){this.expandBtn=document.createElement("button"),this.expandBtn.id="dialoguevault-expand-btn",this.expandBtn.className="floating-expand-btn",this.expandBtn.setAttribute("aria-label","Open DialogueVault navigator"),this.expandBtn.innerHTML='\n      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">\n        <path d="M3 12h18M3 6h18M3 18h18"/>\n      </svg>\n    ',this.expandBtn.style.cssText="\n      position: fixed;\n      width: 48px;\n      height: 48px;\n      border-radius: 12px;\n      background: #e6d7c4;\n      color: #5d4e37;\n      border: 1px solid #d4c4a8;\n      cursor: pointer;\n      z-index: 10001;\n      box-shadow: 0 2px 8px rgba(93, 78, 55, 0.15);\n      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    ",this.expandBtn.addEventListener("click",()=>this.showSidebar()),this.expandBtn.addEventListener("mouseover",()=>{this.expandBtn&&(this.expandBtn.style.backgroundColor="#e4d5c2",this.expandBtn.style.borderColor="#d2c2a6",this.expandBtn.style.boxShadow="0 4px 12px rgba(93, 78, 55, 0.2)",this.expandBtn.style.transform="translateY(-1px)")}),this.expandBtn.addEventListener("mouseout",()=>{this.expandBtn&&(this.expandBtn.style.backgroundColor="#e6d7c4",this.expandBtn.style.borderColor="#d4c4a8",this.expandBtn.style.boxShadow="0 2px 8px rgba(93, 78, 55, 0.15)",this.expandBtn.style.transform="translateY(0)")}),document.body.appendChild(this.expandBtn)}getShareButtonRect(){const e=document.querySelector('button[aria-label*="Share" i]')||document.querySelector('button:has(svg[aria-label*="Share" i])')||Array.from(document.querySelectorAll("button")).find(e=>/share/i.test(e.textContent||""));return e?e.getBoundingClientRect():null}getSearchInputRect(){const e=document.querySelector('input[type="search"]')||document.querySelector('header input[type="text"]')||document.querySelector('form input[type="search"]');return e?e.getBoundingClientRect():null}positionExpandBtnDesktop(){if(this.isMobile||!this.expandBtn)return;const e=this.getShareButtonRect();if(e){const t=10;this.expandBtn.style.position="fixed",this.expandBtn.style.top=Math.max(10,Math.round(e.bottom+t))+"px",this.expandBtn.style.right=Math.max(20,Math.round(window.innerWidth-e.right+8))+"px",this.expandBtn.style.left="",this.expandBtn.style.bottom=""}else this.expandBtn.style.position="fixed",this.expandBtn.style.top="86px",this.expandBtn.style.right="28px",this.expandBtn.style.left="",this.expandBtn.style.bottom="";this.expandBtn.style.display=this.isVisible?"none":"flex"}positionExpandBtnMobile(){if(!this.isMobile||!this.expandBtn)return;const e=this.getSearchInputRect();if(e){const t=Math.max(10,Math.round(e.top-72));this.expandBtn.style.position="fixed",this.expandBtn.style.top=t+"px",this.expandBtn.style.right="16px",this.expandBtn.style.left="",this.expandBtn.style.bottom=""}else this.expandBtn.style.position="fixed",this.expandBtn.style.right="16px",this.expandBtn.style.bottom="36px",this.expandBtn.style.top="",this.expandBtn.style.left="";this.expandBtn.style.display=this.isVisible?"none":"flex"}showExpandBtn(){this.isMobile?this.positionExpandBtnMobile():this.positionExpandBtnDesktop(),this.expandBtn&&(this.expandBtn.style.display=this.isVisible?"none":"flex")}hideExpandBtn(){this.expandBtn&&(this.expandBtn.style.display="none")}showSidebar(){this.isVisible=!0,this.sidebar&&(this.sidebar.classList.add("active"),this.sidebar.classList.remove("collapsed"),this.sidebar.style.display="flex",this.sidebar.style.right="0"),this.hideExpandBtn(),this.isMobile&&this.sidebar&&(this.sidebar.style.width="100%",document.body.style.overflow="hidden"),this.applySelectedStyling()}hideSidebar(){this.isVisible=!1,this.sidebar&&(this.sidebar.classList.remove("active"),this.sidebar.classList.add("collapsed"),this.isMobile?(this.sidebar.style.display="none",document.body.style.overflow=""):this.sidebar.style.right="-300px"),this.isMobile?this.positionExpandBtnMobile():this.positionExpandBtnDesktop(),this.showExpandBtn()}toggleSidebar(){this.isVisible?this.hideSidebar():this.showSidebar()}}})();